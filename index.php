<?php

// Функция для генерации случайного года
function getRandomYear() {
    return rand(1930, 1950);
}

// Функция, обрабатывающая разговор с бабушкой
function startConversation() {
    $countGoodbye = 0;  // Счётчик восклицаний "ПОКА!"
    
    echo "ЧЕГО СКАЗАТЬ-ТО ХОТЕЛ, МИЛОК?!\n";

    while (true) {
        // Чтение введённого текста
        $input = trim(fgets(STDIN));  // Читаем ввод с клавиатуры

        // Проверяем, если введённый текст является "ПОКА!" (независимо от регистра)
        if (strtoupper($input) === "ПОКА!") {
            $countGoodbye++;

            // Если "ПОКА!" повторено 3 раза подряд, заканчиваем разговор
            if ($countGoodbye == 3) {
                echo "ДО СВИДАНИЯ, МИЛЫЙ!\n";
                break;
            }

            // Если меньше 3 раз, бабушка "не слышит"
            echo "НЕТ, НИ РАЗУ С " . getRandomYear() . " ГОДА!\n";
        } else {
            // Проверка, если пользователь кричит (восклицательный знак в конце)
            if (substr($input, -1) === "!") {
                echo "НЕТ, НИ РАЗУ С " . getRandomYear() . " ГОДА!\n";
                $countGoodbye = 0;  // Сбрасываем счётчик "ПОКА!", если кричим
            } else {
                echo "АСЬ?! ГОВОРИ ГРОМЧЕ, ВНУЧЕК!\n";
                $countGoodbye = 0;  // Сбрасываем счётчик "ПОКА!", если не кричим
            }
        }
    }
}

// Запуск программы
startConversation();

?>

